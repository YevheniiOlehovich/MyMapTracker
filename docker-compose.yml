# version: "3.9"

# services:
#   backend:
#     build: ./backend
#     container_name: backend
#     restart: always
#     env_file:
#       - ./backend/src/.env
#     ports:
#       - "5000:5000"
#     volumes:
#       - ./uploads:/app/uploads   # змонтована зовнішня папка uploads

#   gps-service:
#     build: ./gps-service
#     container_name: gps-service
#     restart: always
#     # env_file:
#     #   - ./gps-service/.env
#     ports:
#       - "20120:20120"

#   frontend:
#     build: ./frontend
#     container_name: frontend
#     restart: always
#     ports:
#       - "80:80"
#     volumes:
#       - ./uploads:/usr/share/nginx/html/uploads   # фронтенд бачить ті ж файли
#     depends_on:
#       - backend
#       - gps-service





# services:
#   backend:
#     build: ./backend
#     container_name: backend
#     restart: always
#     env_file:
#       - ./backend/src/.env
#     ports:
#       - "5000:5000"
#     volumes:
#       - ./uploads:/app/uploads   # змонтована зовнішня папка uploads

#   gps-service:
#     build: ./gps-service
#     container_name: gps-service
#     restart: always
#     ports:
#       - "20120:20120"
#     # Якщо згодом буде .env файл для gps-service, можна розкоментувати:
#     # env_file:
#     #   - ./gps-service/.env

#   frontend:
#     build: ./frontend
#     container_name: frontend
#     restart: always
#     ports:
#       - "80:80"
#     volumes:
#       - ./uploads:/usr/share/nginx/html/uploads  # фронтенд бачить ті ж файли
#     depends_on:
#       - backend
#       - gps-service



services:
  backend:
    build: ./backend
    container_name: backend
    restart: always
    env_file:
      - ./backend/src/.env
    expose:
      - "5000"
    volumes:
      - ./uploads:/app/uploads
    networks:
      - app-network

  gps-service:
    build: ./gps-service
    container_name: gps-service
    restart: always
    expose:
      - "20120"
    networks:
      - app-network

  frontend:
    build: ./frontend
    container_name: frontend
    restart: always
    ports:
      - "80:80"
    volumes:
      - ./uploads:/usr/share/nginx/html/uploads
    depends_on:
      - backend
      - gps-service
    networks:
      - app-network

networks:
  app-network:
    driver: bridge
